<!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="initial-scale=1, minimum-scale=1, width=device-width">
<!-- OPEN GRAPH TAGs -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="سيستم‌های پيام‌دهی مگفا">
<meta property="og:description" content="مستندات و نمونه‌کد‌ها را دريافت و مطالعه نماييد">
<meta property="og:image" content="//messaging.magfa.com/ui/public/imgs/mms.png?1739936681">
<meta property="og:image:type" content="image/png">
<meta property="og:url" content="https://messaging.magfa.com/">
<!-- OPEN GRAPH TAGs -->
<meta name="author" content="Magfa Messaging Systems">
<meta name="description" content="مستندات و نمونه‌کد‌ها را دريافت و مطالعه نماييد">
<meta name="keywords" content="سيستم پيامدهی, سامانه پيام‌دهی, پيام‌دهی, پيامک انبوه, ارزش افزوده, SMPP, وب‌سرويس, Webservice, HTTP, SMS Relay, انتقال ترافيک, BULK SMS, VAS, SOAP,,Messaging,پيام‌دهی,بالک,ارزش افروزه,پيامک,پيام کوتاه,اس‌ام‌اس,messaging services,sms panel,web service api,http api,SMS APIS, ورود به سامانه پيام‌دهی">
<title>سيستم‌های پيام‌دهی مگفا - ويکی:سرويس HTTP v2</title>
<link rel="shortcut icon" href="https://messaging.magfa.com/ui/public/imgs/favicon.ico">
<link rel="stylesheet" href="magfa_Http%20v2_files/index.css" type="text/css">
<link rel="stylesheet" href="magfa_Http%20v2_files/index_fa.css" type="text/css">
<script type="text/javascript" async="" src="magfa_Http%20v2_files/analytics.js"></script><script type="text/javascript" src="magfa_Http%20v2_files/jqlib.js"></script>
<script type="text/javascript" src="magfa_Http%20v2_files/common.js"></script>
<link rel="shortcut icon" href="https://messaging.magfa.com/ui/favicon.ico">
</head>
<body id="v">
	<header>
		<div id="cookie">متاسفانه در مرورگر شما امکان استفاده از  کوکی (cookie) وجود ندارد. لطفا آن را فعال نماييد</div>
		<div id="header">
			<div class="inner-wrapper">
				<div id="logo">
					<a id="mgf" href="https://www.magfa.com/" target="new"></a>
					<a id="msg" href="https://messaging.magfa.com/ui/"></a>
				</div>
			    <ul id="navbar">
    <li><a href="https://messaging.magfa.com/ui/?public/apis" class="st ">سرويس‌ها</a></li><li><a href="https://messaging.magfa.com/ui/?public/wiki" class="st ">ويکی</a></li><li><a href="https://messaging.magfa.com/ui/?public/links" class="st ">پيوند‌ها</a></li>    </ul>
    		</div>
		</div>
	</header>
	<section>
		<div id="main" class="inner-wrapper">
		<style type="text/css">html {
scroll-behavior: smooth;
}
header {
position: fixed;
z-index: 10;
left: 0;
right: 0;
top: 0;
}</style><div class="wiki"><div class="md"><!-- cc-gen: 2025-01-29 08:36:59 --><div class="title"><h1>راهنمای سرويس HTTP v2</h1><p>پياده‌سازی شده به صورت REST/JSON</p></div><div class="wrapper"><div class="toc-wrapper"><ul id="toc"><li class="toc-h2 active"><a href="#toc1">آغاز به کار</a></li><li class="toc-h3"><a href="#toc2">مقدمه</a></li><li class="toc-h3"><a href="#toc3">آغاز کار با سرويس</a></li><li class="toc-h2"><a href="#toc4">احراز هويت</a></li><li class="toc-h2"><a href="#compress">فشرده‌سازی</a></li><li class="toc-h2"><a href="#toc5">متدهای HTTP</a></li><li class="toc-h2"><a href="#toc6">متدها</a></li><li class="toc-h3"><a href="#balance">متد balance</a></li><li class="toc-h3"><a href="#send">متد send</a></li><li class="toc-h3"><a href="#mid">متد ‫‪mid</a></li><li class="toc-h3"><a href="#statuses">متد ‫‪statuses</a></li><li class="toc-h3"><a href="#messages">متد ‫‪messages</a></li><li class="toc-h2"><a href="#errors">کدهای خطا</a></li></ul></div><h2 id="toc1">آغاز به کار</h2><h3 id="toc2">مقدمه</h3><p>سرويس
 ‍HTTP v2 بهينه‌سازی‌شده‌ی سرويس HTTP v1 با متدهای REST و به صورت امن 
HTTPS، طراحی شده و به راحتی در همه‌ی زبان‌های برنامه‌نويسی قابل استفاده 
است. به دلیل سربار کم این سرويس، پهنای باند مصرفی در آن بسیار اندک خواهد
 بود. شایان ذکر است در این سرويس نیز تنها از UTF-8 پشتيبانی می‌شود.
<br>
افزون بر امکانات نسخه‌ی v1 امکان در‌یافت پيامک‌های ورودی نيز در اين سرويس فراهم شده است.
<br>
همانند نسخه v1، در اين سرويس نيز سامانه به ازای هر پيامک ارسالی، 
شناسه‌ای یکتا جهت پيگیری وضعيت ارایه می‌نمايد. همچنین برای افزايش سرعت 
ارسال می‌توانيد از فراخوانی‌های همزمان استفاده نماييد.</p><h4>نکته‌ها</h4><ol><li><strong>بیشینه تعداد شماره گيرنده در درخواست‌ها يک‌صد (۱۰۰) عدد است. ارسال بيش از این تعداد با کد خطا مواجه خواهد شد</strong></li><li><strong>در
 پاسخ همه‌ی متدها ، پارامتر status نشانگر وضعيت درخواست خواهد بود. مقدار
 صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه
 است.</strong></li></ol><!--- #main ---><h3 id="toc3">آغاز کار با سرويس</h3><h4>گام اول: ايجاد حساب کاربری و ورود به سامانه‌ی پیام‌دهی مگفا</h4><p>پس
 از ايجاد حساب کاربری شما در سامانه‌‌ی پيام‌دهی مگفا، می‌توانيد با 
اطلاعات ورود (نام‌ کاربری/رمزعبور/دامنه) خود، به پنل سامانه‌ی پيام‌دهی 
مگفا وارد شويد.</p><h4>گام دوم: فعال‌سازی شماره</h4><p>جهت فعال‌سازی 
ارسال پیامک، کافی است تا با مراجعه به منوی «مديریت حساب»/«شماره‌ها»، در 
برگه‌ی «اطلاعات شماره‌ها» مشخصات استفاده‌کننده‌ی نهايی شماره را وارد 
نمايید. پس از ثبت موفق، این اطلاعات برای بررسی به سامانه‌ی احراز هويت 
ارسال شده و پس از لحظاتی در صورت درست بودن اطلاعات، وضعیت آن به تاييد 
شده (تيک سبز) تغيير خواهد یافت.</p><!--- #main ---><h4 id="pass">گام سوم: دريافت رمزعبور (گذر واژه) سرويس.</h4><p>پس
 از ورود به سامانه، با مراجعه به منوی «مديریت حساب»/«رمز عبور و امنيت»، 
می‌توانيد در برگه‌ی «رمز عبور سرويس‌ها» از سامانه رمزی دريافت نمايید که 
در فراخوانی سرويس قابل استفاده خواهد بود. برای این منظور باید رمز اصلی 
را که هنگام ورود به سامانه وارد نموده‌اید بار ديگر وارد نماييد تا به 
صورت خودکار رمز عبور سرويس برای شما توليد شود. پس از توليد در هنگام 
فراخوانی سرويس، از رمز سرويس توليد شده استفاده نماييد.</p><h4>گام چهارم: معرفی آی‌پی‌های معتبر</h4><p>افزون
 بر فراخوانی سرويس به صورت HTTPS، در صورت نياز با مراجعه به منوی «مديریت
 حساب»/«رمز عبور و امنيت»، می‌توانيد در برگه‌ی «آی‌پی‌های معتبر» اقدام 
به فعال‌سازی بررسی و همچنین ثبت آی‌پی(های) مبدا نماييد. بدیهی است با 
فعال‌سازی این بخش درخواست‌هایی با مبدا غير از آی‌پی‌های معرفی‌شده با 
پیغام خطا مواجه شده و سامانه از پاسخ‌گویی به این درخواست‌ها خودداری 
می‌نمايد.</p><h2 id="toc4">احراز هويت</h2><p>احراز هويت اين سرويس بر 
اساس ارسال نام‌کاربری، رمز عبور سرويس و دامنه در سرایند HTTP با کليد 
Authorization و به صورت HTTP Basic Authentication است که در آن username 
به صورت ترکيب «نام‌کاربری به همراه دامنه» و password نيز همان رمز عبور 
سرويس ، به صورت زير است:</p><blockquote><p>USERNAME<strong>/</strong>DOMAIN<strong>:</strong>PASSWORD</p></blockquote><p>&nbsp;</p><blockquote><p>GET <a href="https://sms.magfa.com/api/http/sms/v2">https://sms.magfa.com/api/http/sms/v2</a></p><p>Authorization: Basic VVNFUk5BTUUvRE9NQUlOOlBBU1NXT1JECg==</p></blockquote><h2 id="compress">فشرده‌سازی</h2><p>برای کاهش پهنای باند مصرفی و همچنين افزايش سرعت ارسال اطلاعات در شبکه، امکان فشرده‌سازی درخواست‌ها و پاسخ‌ها وجود دارد.
نحوه‌ی به کارگيری این قابليت در نمونه کدها نشان داده شده است</p><h2 id="toc5">متدهای HTTP</h2><table><thead><tr><th>متد HTTP</th><th>توضيحات</th></tr></thead><tbody><tr><td>GET</td><td>همه‌ی متدها به جز ارسال پيامک</td></tr><tr><td>POST</td><td>تنها متد ارسال پيامک</td></tr></tbody></table><h2 id="toc6">متدها</h2><p>متدهای پیاده‌سازی‌شده به شرح زير است:</p><table><thead><tr><th>متد</th><th>توضيحات</th></tr></thead><tbody><tr><td><a href="#balance">balance</a></td><td>دريافت مانده اعتبار حساب</td></tr><tr><td><a href="#send">send</a></td><td>ارسال پيامک به يک یا چند گيرنده (حداکثر يک‌صد (۱۰۰) عدد)</td></tr><tr><td><a href="#mid">‫‪mid</a></td><td>دريافت شناسه یکتای پيامک  متناظر با شناسه کاربر</td></tr><tr><td><a href="#statuses">‫‪statuses</a></td><td>پيگيری وضعيت نهایی پيامک</td></tr><tr><td><a href="#messages">‫‪messages</a></td><td>دریافت پیامک‌های ورودی (حداکثر يک‌صد (۱۰۰) عدد)</td></tr></tbody></table><h3 id="balance">متد balance</h3><p>از اين متد برای دريافت مانده اعتبار حساب استفاده می‌شود.</p><h4>URL</h4><blockquote><p><a href="https://sms.magfa.com/api/http/sms/v2/balance">https://sms.magfa.com/api/http/sms/v2/balance</a></p></blockquote><h4>پارامترها</h4><p>ندارد</p><h4>خروجی</h4><p>به صورت JSON به شکل زير / <a href="#errors">کدهای خطا</a></p><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 0,
&nbsp;&nbsp;&nbsp;&nbsp;"balance" : 1000
}</code></pre><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 18,
&nbsp;&nbsp;&nbsp;&nbsp;"balance" : null
}</code></pre><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>status</td><td style="text-align: center;">int</td><td>status نشانگر وضعيت درخواست خواهد بود. مقدار صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه است.</td></tr><tr><td>balance</td><td style="text-align: center;">long</td><td>مانده اعتبار</td></tr></tbody></table><h4>نمونه‌کد</h4><dl><dt class="current"><a href="#">curl</a></dt><dd class="current"><pre><code class="language-sh"># bash<br><br># credentials
username='username'
password='password'
domain='domain'<br><br># call
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/balance'</code></pre></dd><dt><a href="#">php</a></dt><dd><pre><code class="language-php">// credentials
$username = "username";
$password = "password";
$domain = "magfa";<br><br>// url
$url = 'https://sms.magfa.com/api/http/sms/v2/balance';<br><br>// Initializes a new cURL session
$ch = curl_init($url);<br><br>// Set the CURLOPT options
curl_setopt($ch, CURLOPT_HEADER, FALSE);<br><br>// JSON
curl_setopt($ch, CURLOPT_HTTPHEADER, ['Accept: application/json']);<br><br>// Basic Auth
curl_setopt($ch, CURLOPT_USERPWD, $username."/".$domain . ":" . $password);<br><br>// Set the CURLOPT_RETURNTRANSFER option to true
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);<br><br>// call
$response = curl_exec($ch);
var_dump(json_decode($response, true));</code></pre></dd><dt><a href="#">java</a></dt><dd><pre><code class="language-java">/*
* Java samples are made with glassfish jersey-client
*/<br><br>// Credentials
String username = "username";
String password = "password";
String domain = "domain";<br><br>// Url
String url = "https://sms.magfa.com/api/http/sms/v2/";<br><br>// Auth
HttpAuthenticationFeature feature = HttpAuthenticationFeature.basic(username + "/" + domain, password);<br><br>// Client
Client client = ClientBuilder.newBuilder()
&nbsp;&nbsp;&nbsp;&nbsp;.register(feature)
&nbsp;&nbsp;&nbsp;&nbsp;.build();<br><br>// call
CreditResult response = client.target(url)
&nbsp;&nbsp;&nbsp;&nbsp;.path("balance/")
&nbsp;&nbsp;&nbsp;&nbsp;.request(MediaType.APPLICATION_JSON)
&nbsp;&nbsp;&nbsp;&nbsp;.get(CreditResult.class);<br><br>if(response.getStatus() != 0 )
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("error: " + response.getStatus());
else
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("mid: " + response.getBalance());</code></pre></dd><dt><a href="#">python</a></dt><dd><pre><code class="language-py">#
# Python samples are made with Requests: HTTP for Humans
#
# https://requests.readthedocs.io/en/master/
#
import requests<br><br>url = "https://sms.magfa.com/api/http/sms/v2/balance"
headers = {'accept': "application/json", 'cache-control': "no-cache"}<br><br># credentials
username = "username"
password = "password"
domain = "domain"<br><br># call
response = requests.get(url, headers=headers, auth=(username + '/' + domain, password))
print(response.json())</code></pre></dd><dt><a href="#">C#</a></dt><dd><pre><code class="language-cs">/**
* C# samples are made with RestSharp
* REST API client library for .Net
*
* https://restsharp.dev/
* --version 110.2.0
*/
using RestSharp;
using RestSharp.Authenticators;<br><br>// Credentials
string username = "username";
string password = "password";
string domain = "magfa";<br><br>var baseAddress = "https://sms.magfa.com/api/http/sms/v2";<br><br>// Options
var options = new RestClientOptions(baseAddress) {
&nbsp;&nbsp;&nbsp;&nbsp;// Auth
&nbsp;&nbsp;&nbsp;&nbsp;Authenticator = new HttpBasicAuthenticator(username + "/" + domain, password),
&nbsp;&nbsp;&nbsp;&nbsp;ThrowOnAnyError = true
};<br><br>// Client
var client = new RestClient(options);<br><br>// Request
var request = new RestRequest("balance");
request.AddHeader("cache-control", "no-cache");
request.AddHeader("accept", "application/json");<br><br>// Call
var response = await client.GetAsync(request);
Console.WriteLine(response.Content);</code></pre></dd></dl><h3 id="send">متد send</h3><p>برای
 ارسال يک يا چند پيامک به يک یا چند گيرنده (حداکثر ۱۰۰ عدد) از اين متد 
می‌توان استفاده کرد.
مقدار بازگشتی این متد حاوی آرایه‌ای است که مقادير آن نشانگر شرايط 
درخواست است
بدین ترتيب که اگر پارامتر‌ها صحيح باشند و پيامک به صورت موفقيت‌آميز در 
سيستم پيام‌دهی قرار گيرد به ازای هر پيامک، شناسه يکتای پيامک، شناسه 
کاربر، تعداد بخش، تعرفه، الفبا (DEFAULT برای لاتین و UCS2 برای فارسی) به
 همراه شماره گیرنده 
يا  کد خطا به همراه شناسه کاربر و شماره گيرنده در خروجی قرار خواهد گرفت.
<br>
ارسال پيامک به دو صورت ارسال پارامترها به صورت JSON و همچنین FORM قابل انجام است.
<br>
همچنین همه‌ی پارامترها به صورت آرایه بوده و امکان ارسال به صورت یک به 
چند (درصورتی که تعداد گیرندگان چند عدد باشد و بقیه  پارامتر‌ها يکی)، و 
چند به چند (در صورتی که پارامترهای فرستنده، گيرنده و متن چندين عدد و به 
 تعداد برابر) وجود دارد.</p><h4>URL</h4><blockquote><p><a href="https://sms.magfa.com/api/http/sms/v2/send">https://sms.magfa.com/api/http/sms/v2/send</a></p></blockquote><h4>پارامترها</h4><p>تمامی پارامترها به صورت URL-ENCODED ارسال شوند</p><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th style="text-align: center;">اجباری؟</th><th>توضيحات</th></tr></thead><tbody><tr><td>senders</td><td style="text-align: center;">string</td><td style="text-align: center;">بله</td><td><a href="#short-no">آرايه‌ای از فرستنده</a></td></tr><tr><td>recipients</td><td style="text-align: center;">string</td><td style="text-align: center;">بله</td><td><a href="#recipients">آرايه‌ای از گيرنده</a></td></tr><tr><td>messages</td><td style="text-align: center;">string</td><td style="text-align: center;">بله</td><td><a href="#text">آرايه‌ای از پيام</a></td></tr><tr><td>encodings</td><td style="text-align: center;">int</td><td style="text-align: center;"></td><td>آرايه‌ای از يکی از مقادير 0 (تشخيص خودکار زبان پیامک[پيش فرض])، 2 (فارسی)، 5 (ارسال به صورت 8BIT) و 6 (ارسال به صورت BINARY)</td></tr><tr><td>uids</td><td style="text-align: center;">long</td><td style="text-align: center;"></td><td><a href="#mid">آرايه‌ای از شناسه‌ی یکتای کاربر</a></td></tr><tr><td>udhs</td><td style="text-align: center;">string</td><td style="text-align: center;"></td><td>آرايه‌ای از UDH (برای اطلاعات بيشتر به مستند UDH مراجعه نماييد)</td></tr></tbody></table><h5 id="short-no">فرستنده</h5><p>شماره فرستنده به یکی از حالت‌های زير قابل استفاده است:</p><ul><li>3000xxxxxx</li><li>983000xxxxxx</li><li><span style="direction:ltr" dir="ltr">+983000xxxxxx</span></li></ul><h5 id="recipients">گيرنده</h5><p>شماره‌ی گيرنده را به صورت‌های زير می‌توانيد مورد استفاده قرار دهيد.</p><ul><li>09xxxxxxxxx</li><li>989xxxxxxxxx</li><li><span style="direction:ltr" dir="ltr">+989xxxxxxxxx</span></li><li>9xxxxxxxxx</li></ul><h5 id="text">پيام</h5><p>متن
 پيامک بايد به صورت UTF-8 باشد.
بر اساس نوع متن (فارسی، لاتین و باينری)، طول متن و نيز با توجه به 
تعرفه‌ی تخصیص‌داده‌شده به حساب، هزينه‌ی پيامک تشخيص داده‌شده و از مانده 
اعتبار کسر می‌گردد.
با توجه به محدود بودن حجم پیامک در استاندارد شبکه‌های تلفن همراه (۱۴۰ 
بايت)،  شرکت مگفا به صورت خودکار و در صورت نياز (طولانی بودن متن پيامک) 
اقدام به شکستن متن طولانی به تعداد بخش‌های مناسب می‌نمايد.
<br>
طول استاندارد يک پيامک فارسی ۷۰ کاراکتر ( هر کاراکتر ۲ بايت)، پيامک باينری ۱۴۰ بايت و لاتین ۱۶۰ کاراکتر (هر کاراکتر ۷ بيت) است.
وجود حتی يک کاراکتر چند بايتی (غير ASCII) منجر به تشخيص پيامک به صورت فارسی خواهد شد تا متن ارسالی به درستی ارسال گردد.
<br>
با توجه به این که گوشی برای تشخيص بخش‌های یک پيامک نياز به اطلاعاتی 
دارد، قسمتی از حجم پيامک (معمولا ۶ بايت از ۱۴۰ بایت) صرف این اطلاعات 
خواهد شد. در اين صورت برای پيامک‌های طولانی هر بخش پيامک فارسی ۶۷ و هر 
بخش پيامک لاتين ۱۵۳ کاراکتر می‌تواند داشته باشد.</p><h4>خروجی</h4><p>مشخصات پيامک‌های ارسالی به صورت زیر / <a href="#errors">کدهای خطا</a></p><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 0,
&nbsp;&nbsp;&nbsp;&nbsp;"messages" : [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "status" : 13, "userId" : "1223", "recipient" : "98912xxxxxxx" },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "status" : 0, "id": 111111111, "userId" : 1224, "parts": 3, "tariff": 160.00, "alphabet": "UCS2", "recipient" : "98913xxxxxxx"}
&nbsp;&nbsp;&nbsp;&nbsp;]
}</code></pre><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 19,
&nbsp;&nbsp;&nbsp;&nbsp;"messages" : []
}</code></pre><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>status</td><td style="text-align: center;">int</td><td>status نشانگر وضعيت درخواست خواهد بود. مقدار صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه است.</td></tr><tr><td>messages</td><td style="text-align: center;">array</td><td>نتيجه‌‌ی پردازش پيامک‌های ارسالی</td></tr></tbody></table><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>status</td><td style="text-align: center;">int</td><td>status نشانگر وضعيت درخواست خواهد بود. مقدار صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه است.</td></tr><tr><td>id</td><td style="text-align: center;">long</td><td>شناسه يکتای پیامک</td></tr><tr><td>userId</td><td style="text-align: center;">long</td><td><a href="#mid">شناسه‌ی یکتای کاربر</a></td></tr><tr><td>parts</td><td style="text-align: center;">int</td><td>تعداد بخش‌های پيامک</td></tr><tr><td>tariff</td><td style="text-align: center;">float</td><td>تعرفه</td></tr><tr><td>alphabet</td><td style="text-align: center;">string</td><td>DEFAULT برای لاتین و UCS2 برای فارسی</td></tr><tr><td>recipient</td><td style="text-align: center;">string</td><td>گيرنده</td></tr></tbody></table><h4>نمونه‌کد</h4><dl><dt class="current"><a href="#">curl</a></dt><dd class="current"><pre><code class="language-sh"># bash<br><br># credentials
username='username'
password='password'
domain='domain'<br><br># post json data
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;-H "Content-Type: application/json" \
&nbsp;&nbsp;&nbsp;&nbsp;-d '{"senders": ["3000xx", "3000xxxxxxxx"], "messages":["test msg", "پيامک فارسی"],"recipients":["0912xxxxxxx","0903xxxxxxx"]}' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/send'<br><br># post gzip compressed json data
echo '{"senders": ["30008710", "30008710"], "messages":["test msg", "پيامک فارسی"],"recipients":["0912xxxxxxx","0903xxxxxxx"]}' | \
gzip | \
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;-H "Content-Type: application/json" \
&nbsp;&nbsp;&nbsp;&nbsp;-H "Content-Encoding: gzip" \
&nbsp;&nbsp;&nbsp;&nbsp;--data-binary @-
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/send'<br><br># or post form data
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;-d 'senders=3000xx&amp;senders=3000xxxxxxxx&amp;messages=test msg&amp;messages=پيامک فارسی&amp;recipients=0912xxxxxxx&amp;recipients=0903xxxxxxx' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/send'</code></pre></dd><dt><a href="#">php</a></dt><dd><pre><code class="language-php">// credentials
$username = "username";
$password = "password";
$domain = "magfa";<br><br>// url
$url = 'https://sms.magfa.com/api/http/sms/v2/send';<br><br>// data
$data = [
&nbsp;&nbsp;&nbsp;&nbsp;"senders" =&gt; ["3000xx", "3000xxxxxxxx"],
&nbsp;&nbsp;&nbsp;&nbsp;"messages" =&gt; ["test msg", "msg 2"],
&nbsp;&nbsp;&nbsp;&nbsp;"recipients" =&gt; ["0912xxxxxxx","0903xxxxxxx"]
];<br><br>// Initializes a new cURL session
$ch = curl_init($url);<br><br>$header = ['Accept: application/json'];<br><br>// Set the CURLOPT options
curl_setopt($ch, CURLOPT_HEADER, FALSE);
// GZIP Decompression
curl_setopt($ch,CURLOPT_ENCODING , "gzip");<br><br>// Basic Auth
curl_setopt($ch, CURLOPT_USERPWD, $username."/".$domain . ":" . $password);<br><br>// Set the CURLOPT_RETURNTRANSFER option to true
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
//
// IF want send JSON {
$post_data = json_encode($data);
$header[] = 'Content-Type: application/json';
// IF want send GZip compressed
$post_data = gzencode($post_data);
$header[] = 'Content-Encoding: gzip';
//}
// ELSE IF POST Data {
// $post_data = preg_replace('/%5B[0-9]+%5D=/', '=', http_build_query($data));
// }
//
// Attach our encoded data string to the POST fields.
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);
// set headers
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);<br><br>// call
$response = curl_exec($ch);
curl_close($ch);
var_dump(json_decode($response, true));</code></pre></dd><dt><a href="#">java</a></dt><dd><pre><code class="language-java">/*
* Java samples are made with glassfish jersey-client
*/<br><br>// Credentials
String username="username";
String password="password";
String domain="domain";<br><br>// Url
String url="https://sms.magfa.com/api/http/sms/v2/";<br><br>// Auth
HttpAuthenticationFeature feature=HttpAuthenticationFeature.basic(username+"/"+domain,password);<br><br>// Client
Client client=ClientBuilder.newBuilder()
&nbsp;&nbsp;&nbsp;&nbsp;.register(feature)
&nbsp;&nbsp;&nbsp;&nbsp;// enable GZIP Compression accepting data
&nbsp;&nbsp;&nbsp;&nbsp;.register(EncodingFilter.class)
&nbsp;&nbsp;&nbsp;&nbsp;.register(GZipEncoder.class)
&nbsp;&nbsp;&nbsp;&nbsp;// enable GZIP Compression sending data
&nbsp;&nbsp;&nbsp;&nbsp;.property(ClientProperties.USE_ENCODING,"gzip")
&nbsp;&nbsp;&nbsp;&nbsp;.build();<br><br>// ----- Data -----
@XmlRootElement
class Data {
&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;messages=new ArrayList();
&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;recipients=new ArrayList();
&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;senders=new ArrayList();
&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;uids=new ArrayList();
&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;encodings=new ArrayList();
&nbsp;&nbsp;&nbsp;&nbsp;List&lt;String&gt;udhs=new ArrayList();
}<br><br>Data data = new Data();
// senders
data.senders.add("3000xx");
data.senders.add("3000xxxxxxxx");
// messages
data.messages.add("test msg");
data.messages.add("msg 2");
// recipients
data.recipients.add("0912xxxxxxx");
data.recipients.add("0903xxxxxxx");
//----- Data -----<br><br>// Call
SendResult response = client.target(url)
&nbsp;&nbsp;&nbsp;&nbsp;.path("send/")
&nbsp;&nbsp;&nbsp;&nbsp;.request(MediaType.APPLICATION_JSON)
&nbsp;&nbsp;&nbsp;&nbsp;.post(Entity.entity(data, MediaType.APPLICATION_JSON), SendResult.class);<br><br>if ( response.getStatus() !=0 ) {
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("error: "+response.getStatus());
} else {
&nbsp;&nbsp;&nbsp;&nbsp;for( SendMessage msg : response.getMessages())
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (msg.getStatus() != 0 ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("error: " + msg.getStatus());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("mid: " + msg.getId());
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}</code></pre></dd><dt><a href="#">python</a></dt><dd><pre><code class="language-py">#
# Python samples are made with Requests: HTTP for Humans
#
# https://requests.readthedocs.io/en/master/
#
import requests<br><br>url = "https://sms.magfa.com/api/http/sms/v2/send"
headers = {'accept': "application/json", 'cache-control': "no-cache"}<br><br># credentials
username = "username"
password = "password"
domain = "domain"<br><br># data
payload_tuples = [('senders': '3000xx'), ('senders':'3000xxxxxxxx'), ('messages':'test msg'), ('messages':'msg 2'), ('recipients':'0912xxxxxxx'), ('recipients':'0903xxxxxxx')]
# call post form data
response = requests.post(url, headers=headers, auth=(username + '/' + domain, password), data=payload_tuples)<br><br># or json data
payload_json = {'senders': ['3000xx', '3000xxxxxxxx'], 'messages':['test msg','msg 2'], 'recipients':['0912xxxxxxx', '0903xxxxxxx']}
# call json
response = requests.post(url, headers=headers, auth=(username + '/' + domain, password), json=payload_json)
print(response.json())</code></pre></dd><dt><a href="#">C#</a></dt><dd><pre><code class="language-cs">/**
* C# samples are made with RestSharp
* REST API client library for .Net
*
* https://restsharp.dev/
* --version 110.2.0
*/
using RestSharp;
using RestSharp.Authenticators;<br><br>// Credentials
string username = "username";
string password = "password";
string domain = "magfa";<br><br>var baseAddress = "https://sms.magfa.com/api/http/sms/v2";<br><br>// Options
var options = new RestClientOptions(baseAddress) {
&nbsp;&nbsp;&nbsp;&nbsp;// Auth
&nbsp;&nbsp;&nbsp;&nbsp;Authenticator = new HttpBasicAuthenticator(username + "/" + domain, password),
&nbsp;&nbsp;&nbsp;&nbsp;ThrowOnAnyError = true
};<br><br>// Client
var client = new RestClient(options);<br><br>// Request
var request = new RestRequest("send", Method.Post);
request.AddHeader("cache-control", "no-cache");
request.AddHeader("accept", "application/json");<br><br>// JSON
request.AddBody(new {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;senders=new[]{"3000xx", "3000xxxxxxxx"},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;messages=new[]{"test msg","msg 2"},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recipients=new[]{"0912xxxxxxx", "0903xxxxxxx"}}
);
// Or POST Params
// request.AddParameter("senders", "3000xx");
// request.AddParameter("senders", "3000xxxxxxxx");
// request.AddParameter("messages", "test msg");
// request.AddParameter("messages", "msg 2");
// request.AddParameter("recipients", "0912xxxxxxx");
// request.AddParameter("recipients", "0903xxxxxxx");<br><br>// Call
var response = await client.PostAsync(request);
Console.WriteLine(response.Content);</code></pre></dd></dl><h3 id="mid">متد ‫‪mid</h3><p>در
 صورتی که هنگام ارسال هر پيامک، شناسه‌ی يکتای کاربر نيز به عنوان 
پارامتر، تحويل شده باشد، با استفاده از اين متد می‌توان شناسه‌ی پیامک 
متناظر با آن را
دريافت کرد.
<br>
شايان ذکر است که مورد استفاده‌ی اين متد جلوگيری از ارسال تکراری پيامک به هنگام رخداد خطای ارتباطی مانند TIMEOUT است.
بدین صورت که پس از بروز چنین خطاهايی هنگام ارسال پيامک به همراه شناسه‌ی يکتای کاربر،
با فراخوانی این متد به ازای شناسه‌های يکتا و دریافت شناسه پیامک می‌توان از ارسال دوباره پيشگيری نمود .</p><h4>پارامترها</h4><p>تمامی پارامترها به صورت URL-ENCODED ارسال شوند</p><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th style="text-align: center;">اجباری؟</th><th>توضيحات</th></tr></thead><tbody><tr><td>uid</td><td style="text-align: center;">long</td><td style="text-align: center;">بله</td><td>شناسه‌ی یکتای کاربر</td></tr></tbody></table><h4>URL</h4><blockquote><p><a href="https://sms.magfa.com/api/http/sms/v2/mid/%7Buid">https://sms.magfa.com/api/http/sms/v2/mid/{uid</a>}</p></blockquote><h4>خروجی</h4><p>به صورت JSON به شکل زير / <a href="#errors">کدهای خطا</a></p><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 0,
&nbsp;&nbsp;&nbsp;&nbsp;"mid" : 1111111111
}</code></pre><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 18,
&nbsp;&nbsp;&nbsp;&nbsp;"mid" : -1
}</code></pre><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>status</td><td style="text-align: center;">int</td><td>status نشانگر وضعيت درخواست خواهد بود. مقدار صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه است.</td></tr><tr><td>mid</td><td style="text-align: center;">long</td><td>شناسه يکتای پیامک  یا ۱- در صورت نيافتن شناسه</td></tr></tbody></table><h4>نمونه‌کد</h4><dl><dt class="current"><a href="#">curl</a></dt><dd class="current"><pre><code class="language-sh"># bash<br><br># credentials
username='username'
password='password'
domain='domain'<br><br># call
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/mid/123453'</code></pre></dd><dt><a href="#">php</a></dt><dd><pre><code class="language-php">// credentials
$username = "username";
$password = "password";
$domain = "magfa";<br><br>// url
$uid = 1234;
$url = 'https://sms.magfa.com/api/http/sms/v2/mid/'.$uid;<br><br>// Initializes a new cURL session
$ch = curl_init($url);<br><br>// Set the CURLOPT options
curl_setopt($ch, CURLOPT_HEADER, FALSE);
// JSON
curl_setopt($ch, CURLOPT_HTTPHEADER, ['Accept: application/json']);<br><br>// Basic Auth
curl_setopt($ch, CURLOPT_USERPWD, $username."/".$domain . ":" . $password);<br><br>// Set the CURLOPT_RETURNTRANSFER option to true
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);<br><br>// call
$response = curl_exec($ch);
$result = json_decode($response, true);
if($result['status'] != 0 )
&nbsp;&nbsp;&nbsp;&nbsp;var_dump($result['status']);
else
&nbsp;&nbsp;&nbsp;&nbsp;var_dump($result['mid']);</code></pre></dd><dt><a href="#">java</a></dt><dd><pre><code class="language-java">/*
* Java samples are made with glassfish jersey-client
*/<br><br>// Credentials
String username = "username";
String password = "password";
String domain = "domain";<br><br>// Url
String url = "https://sms.magfa.com/api/http/sms/v2/";
// Auth
HttpAuthenticationFeature feature = HttpAuthenticationFeature.basic(username + "/" + domain, password);<br><br>// Client
Client client = ClientBuilder.newBuilder()
&nbsp;&nbsp;&nbsp;&nbsp;.register(feature)
&nbsp;&nbsp;&nbsp;&nbsp;.build();<br><br>// call
long uid = 12345L;
MessageIdResult response = client.target(url)
&nbsp;&nbsp;&nbsp;&nbsp;.path("mid/" + uid)
&nbsp;&nbsp;&nbsp;&nbsp;.request(MediaType.APPLICATION_JSON)
&nbsp;&nbsp;&nbsp;&nbsp;.get(MessageIdResult.class);
&nbsp;&nbsp;&nbsp;&nbsp;
// resp
if(response.getStatus() != 0 )
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("error: " + response.getStatus());
else
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("mid: " + response.getMid());</code></pre></dd><dt><a href="#">python</a></dt><dd><pre><code class="language-py">#
# Python samples are made with Requests: HTTP for Humans
#
# https://requests.readthedocs.io/en/master/
#
import requests<br><br>uid = 12345
url = "https://sms.magfa.com/api/http/sms/v2/mid/" + uid
headers = {'accept': "application/json", 'cache-control': "no-cache"}<br><br># credentials
username = "username"
password = "password"
domain = "domain"<br><br># call
response = requests.get(url, headers=headers, auth=(username + '/' + domain, password))
print(response.json())</code></pre></dd><dt><a href="#">C#</a></dt><dd><pre><code class="language-cs">/**
* C# samples are made with RestSharp
* REST API client library for .Net
*
* https://restsharp.dev/
* --version 110.2.0
*/
using RestSharp;
using RestSharp.Authenticators;<br><br>// Credentials
string username = "username";
string password = "password";
string domain = "magfa";<br><br>var baseAddress = "https://sms.magfa.com/api/http/sms/v2";<br><br>var userId = 12345;<br><br>// Options
var options = new RestClientOptions(baseAddress) {
&nbsp;&nbsp;&nbsp;&nbsp;// Auth
&nbsp;&nbsp;&nbsp;&nbsp;Authenticator = new HttpBasicAuthenticator(username + "/" + domain, password),
&nbsp;&nbsp;&nbsp;&nbsp;ThrowOnAnyError = true
};<br><br>// Client
var client = new RestClient(options);<br><br>// Request
var request = new RestRequest("mid/userid").AddUrlSegment("userid", userId);
request.AddHeader("cache-control", "no-cache");
request.AddHeader("accept", "application/json");<br><br>// Call
var response = await client.GetAsync(request);
Console.WriteLine(response.Content);</code></pre></dd></dl><h3 id="statuses">متد ‫‪statuses</h3><p>برای پيگيری وضعيت نهایی پيامک از اين متد می‌توانيد استفاده نماييد</p><h4>پارامترها</h4><p>تمامی پارامترها به صورت URL-ENCODED ارسال شوند</p><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th style="text-align: center;">اجباری؟</th><th>توضيحات</th></tr></thead><tbody><tr><td>mids</td><td style="text-align: center;">long</td><td style="text-align: center;">بله</td><td>شناسه يکتای پیامک (حد اکثر يک‌صد (۱۰۰) عدد و جدا شده با کاما)</td></tr></tbody></table><h4>URL</h4><blockquote><p><a href="https://sms.magfa.com/api/http/sms/v2/statuses/%7Bmid1,mid2">https://sms.magfa.com/api/http/sms/v2/statuses/{mid1,mid2</a>,...}</p></blockquote><h4>خروجی</h4><p>به ازای هر شناسه، یک از مقادير زير به عنوان وضعيت بازگشت داده می‌شود / <a href="#errors">کدهای خطا</a></p><h5 id="status">وضعيت</h5><ul><li><span style="direction:ltr">1-</span>: شناسه موجود نيست (شناسه نادرست یا گذشت بيش از ۲۴ ساعت از ارسال پيامک)</li><li>0: وضعيتی دريافت نشده</li><li>1: رسیده به گوشی</li><li>2: نرسیده به گوشی</li><li>8: رسیده به مخابرات</li><li>16: نرسیده به مخابرات</li></ul><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 0,
&nbsp;&nbsp;&nbsp;&nbsp;"dlrs" : [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{"mid" : 1234567, "status" : 8, "date" : "2020-01-01 00:00:00"},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{"mid" : 7654321, "status" : -1, "date" : "2020-01-01 10:10:00"}
&nbsp;&nbsp;&nbsp;&nbsp;]
}</code></pre><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status":19,
&nbsp;&nbsp;&nbsp;&nbsp;"dlrs":[]
}</code></pre><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>status</td><td style="text-align: center;">int</td><td>status نشانگر وضعيت درخواست خواهد بود. مقدار صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه است.</td></tr><tr><td>dlrs</td><td style="text-align: center;">array</td><td>آرايه‌ای از وضعيت شناسه‌های ارسالی</td></tr></tbody></table><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>mid</td><td style="text-align: center;">long</td><td>شناسه يکتای پیامک</td></tr><tr><td>status</td><td style="text-align: center;">int</td><td><a href="#status">وضعيت</a></td></tr><tr><td>date</td><td style="text-align: center;">string</td><td>تاريخ (yyyy-mm-dd hh:mm:ss)</td></tr></tbody></table><h4>نمونه‌کد</h4><dl><dt class="current"><a href="#">curl</a></dt><dd class="current"><pre><code class="language-sh"># bash<br><br># credentials
username='username'
password='password'
domain='domain'<br><br># call
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/statuses/12345'</code></pre></dd><dt><a href="#">php</a></dt><dd><pre><code class="language-php">// credentials
$username = "username";
$password = "password";
$domain = "magfa";<br><br>// url
$mids = [1234234, 3546435];
$url = 'https://sms.magfa.com/api/http/sms/v2/statuses/'.implode(',', $mids);<br><br>// Initializes a new cURL session
$ch = curl_init($url);<br><br>// Set the CURLOPT options
curl_setopt($ch, CURLOPT_HEADER, FALSE);<br><br>// JSON
curl_setopt($ch, CURLOPT_HTTPHEADER, ['Accept: application/json']);<br><br>// GZIP Decompression
curl_setopt($ch,CURLOPT_ENCODING , 'gzip');<br><br>// Basic Auth
curl_setopt($ch, CURLOPT_USERPWD, $username."/".$domain . ":" . $password);<br><br>// Set the CURLOPT_RETURNTRANSFER option to true
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);<br><br>// call
$response = curl_exec($ch);
var_dump(json_decode($response, true));</code></pre></dd><dt><a href="#">java</a></dt><dd><pre><code class="language-java">/*
* Java samples are made with glassfish jersey-client
*/<br><br>// Credentials
String username = "username";
String password = "password";
String domain = "domain";<br><br>// Url
String url = "https://sms.magfa.com/api/http/sms/v2/";<br><br>// Auth
HttpAuthenticationFeature feature = HttpAuthenticationFeature.basic(username + "/" + domain, password);<br><br>// Client
Client client = ClientBuilder.newBuilder()
&nbsp;&nbsp;&nbsp;&nbsp;.register(feature)
&nbsp;&nbsp;&nbsp;&nbsp;// enable GZIP Compression receiving data
&nbsp;&nbsp;&nbsp;&nbsp;.register(EncodingFilter.class)
&nbsp;&nbsp;&nbsp;&nbsp;.register(GZipEncoder.class)
&nbsp;&nbsp;&nbsp;&nbsp;.build();<br><br>// call
DeliveryResult response = client.target(url)
&nbsp;&nbsp;&nbsp;&nbsp;.path("statuses/")
&nbsp;&nbsp;&nbsp;&nbsp;.request(MediaType.APPLICATION_JSON)
&nbsp;&nbsp;&nbsp;&nbsp;.get(DeliveryResult.class);<br><br>if(response.getStatus() != 0 )
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("error: " + response.getStatus());
else
&nbsp;&nbsp;&nbsp;&nbsp;for (DeliveryStatus dlr : response.getDlrs()) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("mid: " + dlr.getMid() + ", status: " + dlr.getStatus());
&nbsp;&nbsp;&nbsp;&nbsp;}</code></pre></dd><dt><a href="#">python</a></dt><dd><pre><code class="language-py">#
# Python samples are made with Requests: HTTP for Humans
#
# https://requests.readthedocs.io/en/master/
#
import requests<br><br>mid = 12345
url = "https://sms.magfa.com/api/http/sms/v2/statuses/" + mid
headers = {'accept': "application/json", 'cache-control': "no-cache"}<br><br># credentials
username = "username"
password = "password"
domain = "domain"<br><br># call
response = requests.get(url, headers=headers, auth=(username + '/' + domain, password))
print(response.json())</code></pre></dd><dt><a href="#">C#</a></dt><dd><pre><code class="language-cs">/**
* C# samples are made with RestSharp
* REST API client library for .Net
*
* https://restsharp.dev/
* --version 110.2.0
*/
using RestSharp;
using RestSharp.Authenticators;<br><br>// Credentials
string username = "username";
string password = "password";
string domain = "magfa";<br><br>var mid = 123456789;<br><br>var baseAddress = "https://sms.magfa.com/api/http/sms/v2";<br><br>// Options
var options = new RestClientOptions(baseAddress) {
&nbsp;&nbsp;&nbsp;&nbsp;// Auth
&nbsp;&nbsp;&nbsp;&nbsp;Authenticator = new HttpBasicAuthenticator(username + "/" + domain, password),
&nbsp;&nbsp;&nbsp;&nbsp;ThrowOnAnyError = true
};<br><br>// Client
var client = new RestClient(options);<br><br>// Request
var request = new RestRequest("statuses/mid").AddUrlSegment("mid", mid);
request.AddHeader("cache-control", "no-cache");
request.AddHeader("accept", "application/json");<br><br>// Call
var response = await client.GetAsync(request);
Console.WriteLine(response.Content);</code></pre></dd></dl><h3 id="messages">متد ‫‪messages</h3><p>برای
 دريافت پيامک‌های ورودی با هر بار فراخوانی این متد، حداکثر يک‌صد پيامک 
ورودی به صورت آرایه برگردانده می‌شود. در صورتی که تعداد وارد نشود(URL 
نخست) یا عددی بیش از يک‌صد (۱۰۰) وارد شود، تعداد صد در نظر گرفته می‌شود.</p><h4>پارامترها</h4><p>تمامی پارامترها به صورت URL-ENCODED ارسال شوند</p><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th style="text-align: center;">اجباری؟</th><th>توضيحات</th></tr></thead><tbody><tr><td>count</td><td style="text-align: center;">int</td><td style="text-align: center;">بله</td><td>تعداد پیامک‌های ورودی</td></tr></tbody></table><h4>URL</h4><blockquote><p><a href="https://sms.magfa.com/api/http/sms/v2/messages">https://sms.magfa.com/api/http/sms/v2/messages</a></p><p><a href="https://sms.magfa.com/api/http/sms/v2/messages/%7Bcount">https://sms.magfa.com/api/http/sms/v2/messages/{count</a>}</p></blockquote><h4>خروجی</h4><p>به صورت JSON به شکل زير / <a href="#errors">کدهای خطا</a></p><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 0,
&nbsp;&nbsp;&nbsp;&nbsp;"messages" : [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{"body":"message body", "senderNumber":"98912xxxxxxx", "recipientNumber":"983000xxxx", "date": "2020-01-01 00:00:00"},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{"body":"message body 2", "senderNumber":"98902xxxxxxx", "recipientNumber":"983000xxxx", "date": "2020-01-01 06:00:00"}
&nbsp;&nbsp;&nbsp;&nbsp;]
}</code></pre><pre><code class="language-json">{
&nbsp;&nbsp;&nbsp;&nbsp;"status" : 19,
&nbsp;&nbsp;&nbsp;&nbsp;"messages" : []
}</code></pre><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>status</td><td style="text-align: center;">int</td><td>status نشانگر وضعيت درخواست خواهد بود. مقدار صفر به معنای انجام بدون خطای درخواست و هر عدد غير از صفر کد خطای مربوطه است.</td></tr><tr><td>messages</td><td style="text-align: center;">array</td><td>پيامک‌ها</td></tr></tbody></table><table><thead><tr><th>پارامتر</th><th style="text-align: center;">نوع</th><th>توضيحات</th></tr></thead><tbody><tr><td>body</td><td style="text-align: center;">string</td><td>پيام</td></tr><tr><td>senderNumber</td><td style="text-align: center;">string</td><td>فرستنده</td></tr><tr><td>recipientNumber</td><td style="text-align: center;">string</td><td>گيرنده</td></tr><tr><td>date</td><td style="text-align: center;">string</td><td>تاريخ (yyyy-mm-dd hh:mm:ss)</td></tr></tbody></table><h4>نمونه‌کد</h4><dl><dt class="current"><a href="#">curl</a></dt><dd class="current"><pre><code class="language-sh"># bash<br><br># credentials
username='username'
password='password'
domain='domain'<br><br># call
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/messages/50'<br><br># gzip call
curl --basic --user "$username/$domain:$password" \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept: application/json' \
&nbsp;&nbsp;&nbsp;&nbsp;-H 'Accept-Encoding: gzip' \
&nbsp;&nbsp;&nbsp;&nbsp;'https://sms.magfa.com/api/http/sms/v2/messages/50' | gunzip</code></pre></dd><dt><a href="#">php</a></dt><dd><pre><code class="language-php">// credentials
$username = "username";
$password = "password";
$domain = "magfa";<br><br>// url
$count = 50;
$url = 'https://sms.magfa.com/api/http/sms/v2/messages/'.$count;<br><br>// Initializes a new cURL session
$ch = curl_init($url);<br><br>// Set the CURLOPT options
curl_setopt($ch, CURLOPT_HEADER, FALSE);<br><br>// JSON
curl_setopt($ch, CURLOPT_HTTPHEADER, ['Accept: application/json']);<br><br>// GZIP Decompression
curl_setopt($ch,CURLOPT_ENCODING , 'gzip');<br><br>// Basic Auth
curl_setopt($ch, CURLOPT_USERPWD, $username."/".$domain . ":" . $password);<br><br>// Set the CURLOPT_RETURNTRANSFER option to true
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);<br><br>// call
$response = curl_exec($ch);
$result = json_decode($response, true);
if($result['status'] != 0 )
&nbsp;&nbsp;&nbsp;&nbsp;var_dump($result['status']);
else
&nbsp;&nbsp;&nbsp;&nbsp;var_dump($result['messages']);</code></pre></dd><dt><a href="#">java</a></dt><dd><pre><code class="language-java">/*
* Java samples are made with glassfish jersey-client
*/<br><br>// Credentials
String username = "username";
String password = "password";
String domain = "domain";<br><br>// Url
String url = "https://sms.magfa.com/api/http/sms/v2/";
// Auth
HttpAuthenticationFeature feature = HttpAuthenticationFeature.basic(username + "/" + domain, password);<br><br>// Client
Client client = ClientBuilder.newBuilder()
&nbsp;&nbsp;&nbsp;&nbsp;.register(feature)
&nbsp;&nbsp;&nbsp;&nbsp;// enable GZIP Compression receiving data
&nbsp;&nbsp;&nbsp;&nbsp;.register(EncodingFilter.class)
&nbsp;&nbsp;&nbsp;&nbsp;.register(GZipEncoder.class)
&nbsp;&nbsp;&nbsp;&nbsp;.build();<br><br>// call
int count = 50;
// String shortNumber = "3000xxx";
MessagesResult response = client.target(url)
&nbsp;&nbsp;&nbsp;&nbsp;.path("messages/" + count)
&nbsp;&nbsp;&nbsp;&nbsp;//.path("messages/" + count + "/" + shortNumber)
&nbsp;&nbsp;&nbsp;&nbsp;.request(MediaType.APPLICATION_JSON)
&nbsp;&nbsp;&nbsp;&nbsp;.get(MessagesResult.class);<br><br>if(response.getStatus() != 0 )
&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("error: " + response.getStatus());
else
&nbsp;&nbsp;&nbsp;&nbsp;for (IncomingMessage msg : response.getMessages()) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println("text: " + msg.getBody());
&nbsp;&nbsp;&nbsp;&nbsp;}</code></pre></dd><dt><a href="#">python</a></dt><dd><pre><code class="language-py">#
# Python samples are made with Requests: HTTP for Humans
#
# https://requests.readthedocs.io/en/master/
#
import requests<br><br>count = 50
url = "https://sms.magfa.com/api/http/sms/v2/messages/" + count
headers = {'accept': "application/json", 'cache-control': "no-cache"}<br><br># credentials
username = "username"
password = "password"
domain = "domain"<br><br># call
response = requests.get(url, headers=headers, auth=(username + '/' + domain, password))
print(response.json())</code></pre></dd><dt><a href="#">C#</a></dt><dd><pre><code class="language-cs">/**
* C# samples are made with RestSharp
* REST API client library for .Net
*
* https://restsharp.dev/
* --version 110.2.0
*/
using RestSharp;
using RestSharp.Authenticators;<br><br>// Credentials
string username = "username";
string password = "password";
string domain = "magfa";<br><br>var baseAddress = "https://sms.magfa.com/api/http/sms/v2";<br><br>var count = 50;<br><br>// Options
var options = new RestClientOptions(baseAddress) {
&nbsp;&nbsp;&nbsp;&nbsp;// Auth
&nbsp;&nbsp;&nbsp;&nbsp;Authenticator = new HttpBasicAuthenticator(username + "/" + domain, password),
&nbsp;&nbsp;&nbsp;&nbsp;ThrowOnAnyError = true
};<br><br>// Client
var client = new RestClient(options);<br><br>// Request
var request = new RestRequest("messages/عدد").AddUrlSegment("count", count);
request.AddHeader("cache-control", "no-cache");
request.AddHeader("accept", "application/json");<br><br>// Call
var response = await client.GetAsync(request);
Console.WriteLine(response.Content);</code></pre></dd></dl><h2 id="errors">کدهای خطا</h2><p>جدول کدهای خطا سرويس به شرح زير است</p><table><thead><tr><th style="text-align: center;">کد خطا</th><th>توضيحات</th></tr></thead><tbody><tr><td style="text-align: center;">1</td><td>شماره گيرنده نادرست است</td></tr><tr><td style="text-align: center;">2</td><td>شماره فرستنده نادرست است</td></tr><tr><td style="text-align: center;">3</td><td>پارامتر encoding نامعتبراست. (بررسی صحت و هم‌خوانی متن پيامک با encoding انتخابی)</td></tr><tr><td style="text-align: center;">4</td><td>پارامتر mclass نامعتبر است</td></tr><tr><td style="text-align: center;">6</td><td>پارامتر UDH نامعتبر است</td></tr><tr><td style="text-align: center;">8</td><td>زمان ارسال پيامک، خارج از باره‌ی مجاز ارسال پيامک تبليغاتی (۷ الی ۲۲) است</td></tr><tr><td style="text-align: center;">13</td><td>محتويات پيامک (تركيب UDH و متن) خالی است. (بررسی دوباره‌ی متن پيامک و پارامتر UDH)</td></tr><tr><td style="text-align: center;">14</td><td>مانده اعتبار ريالی مورد نياز برای ارسال پیامک کافی نيست</td></tr><tr><td style="text-align: center;">15</td><td>سرور در هنگام ارسال پيام مشغول برطرف نمودن ايراد داخلی بوده است. (ارسال مجدد درخواست)</td></tr><tr><td style="text-align: center;">16</td><td>حساب غيرفعال است. (تماس با واحد فروش سيستم‌های ارتباطی)</td></tr><tr><td style="text-align: center;">17</td><td>حساب منقضی شده است. (تماس با واحد فروش سيستم‌های ارتباطی)</td></tr><tr><td style="text-align: center;">18</td><td>نام كاربری و يا كلمه عبور نامعتبر است. (بررسی مجدد نام كاربری و كلمه عبور)</td></tr><tr><td style="text-align: center;">19</td><td>درخواست معتبر نيست. (تركيب نام كاربری، رمز عبور و دامنه اشتباه است. تماس با واحد فروش برای دريافت كلمه عبور جديد)</td></tr><tr><td style="text-align: center;">20</td><td>شماره فرستنده به حساب تعلق ندارد</td></tr><tr><td style="text-align: center;">22</td><td>اين سرويس برای حساب فعال نشده است</td></tr><tr><td style="text-align: center;">23</td><td>در حال حاضر امکان پردازش درخواست جديد وجود ندارد، لطفا دوباره سعی كنيد. (ارسال مجدد درخواست)</td></tr><tr><td style="text-align: center;">24</td><td>شناسه پيامک معتبر نيست. (ممكن است شناسه پيامک اشتباه و يا متعلق به پيامكی باشد كه بيش از يک روز از ارسال آن گذشته)</td></tr><tr><td style="text-align: center;">25</td><td>نام متد درخواستی معتبر نيست. (بررسی نگارش نام متد با توجه به بخش متدها در اين راهنما)</td></tr><tr><td style="text-align: center;">27</td><td>شماره گيرنده در ليست سياه اپراتور قرار دارد. (ارسال پيامک‌های تبليغاتی برای اين شماره امكان‌پذير نيست)</td></tr><tr><td style="text-align: center;">28</td><td>شماره گیرنده، بر اساس پیش‌شماره در حال حاضر در مگفا مسدود است</td></tr><tr><td style="text-align: center;">29</td><td>آدرس IP مبدا، اجازه دسترسی به این سرویس را ندارد</td></tr><tr><td style="text-align: center;">30</td><td>تعداد بخش‌های پیامک بیش از حد مجاز استاندارد (۲۶۵ عدد) است</td></tr><tr><td style="text-align: center;">31</td><td>فرمت JSON‌ ارسالی صحيح نیست</td></tr><tr><td style="text-align: center;">33</td><td>مشترک، دريافت پيامک از اين سرشماره را مسدود نموده است (لغو ۱۱) </td></tr><tr><td style="text-align: center;">34</td><td>اطلاعات تایید‌شده برای اين شماره وجود ندارد</td></tr><tr><td style="text-align: center;">101</td><td>طول آرايه پارامتر messageBodies با طول آرايه گيرندگان تطابق ندارد</td></tr><tr><td style="text-align: center;">102</td><td>طول آرايه پارامتر messageClass با طول آرايه گيرندگان تطابق ندارد</td></tr><tr><td style="text-align: center;">103</td><td>طول آرايه پارامتر senderNumbers با طول آرايه گيرندگان تطابق ندارد</td></tr><tr><td style="text-align: center;">104</td><td>طول آرايه پارامتر udhs با طول آرايه گيرندگان تطابق ندارد</td></tr><tr><td style="text-align: center;">105</td><td>طول آرايه پارامتر priorities با طول آرايه گيرندگان تطابق ندارد</td></tr><tr><td style="text-align: center;">106</td><td>آرايه‌ی گيرندگان خالی است</td></tr><tr><td style="text-align: center;">107</td><td>طول آرايه پارامتر گيرندگان بيشتر از طول مجاز است</td></tr><tr><td style="text-align: center;">108</td><td>آرايه‌ی فرستندگان خالی است</td></tr><tr><td style="text-align: center;">109</td><td>طول آرايه پارامتر encoding با طول آرايه گيرندگان تطابق ندارد</td></tr><tr><td style="text-align: center;">110</td><td>طول آرايه پارامتر checkingMessageIds با طول آرايه گيرندگان تطابق ندارد</td></tr></tbody></table></div></div></div><link rel="stylesheet" href="magfa_Http%20v2_files/default.css"><script src="magfa_Http%20v2_files/highlight.min.js"></script><script>var toc = $('.wiki #toc'), anchs = toc.find('a'), map={}, first = $(anchs.get(0)), active;
$(window).scroll(function() {
var scroll = $(window).scrollTop();
var margin = $('.title').outerHeight() + $('header').outerHeight() - 20;
var toc = $('.toc-wrapper');
if (scroll >= margin) {
if (!toc.hasClass('sticky')) toc.addClass('sticky');
} else { toc.removeClass('sticky');
}
active = first;
$.each(map, function(i, v) { if (scroll + 70 >= i) active = v; else return false;
});
toc.find('.active').removeClass('active'); active.parent().addClass('active');
});
$(document).ready(function(){ $('dl dt').each(function(){ var dt = $(this); var a = $('<a href="#"/>').text(dt.text()); a.click(function(e){ e.stopPropagation(); var dl = $(this).closest('dl'); dl.find('.current').removeClass('current'); var dt = $(this).closest('dt'); dt.addClass('current'); var dd= dt.next(); dd.addClass('current'); return false;}); dt.html(a); }); $('dl dt:first-child a').click(); hljs.initHighlightingOnLoad(); anchs.each(function(){ var a = $(this); id = a.attr('href'); var k = Math.round($(id).offset().top); map[k] = a; }); $(window).scroll();
});</script>	</div>
	</section>
	<footer>
		<div id="footer" class="inner-wrapper">
			<a href="http://www.magfa.com/" target="new">
				<img src="magfa_Http%20v2_files/logo_footer.png" alt="مگفا">
			</a>
			<span dir="ltr"><span class="numeric" dir="ltr">۱۳۸۳ - ۱۴۰۳</span>©
</span>
			<a href="https://messaging.magfa.com/ui/?public/about">درباره‌ی ما</a>
			<a href="https://messaging.magfa.com/ui/?public/contact">تماس با ما</a>
			<a class="enamad" href="" id="enamad">
				<img id="hwlaxlapdrftnbpegwmd" style="cursor: pointer;" onclick='window.open("https://trustseal.enamad.ir/Verify.aspx?id=43129&amp;p=odshfuixnbpdwkynjzpg", "Popup","toolbar=no, location=no, statusbar=no, menubar=no, scrollbars=1, resizable=0, width=580, height=600, top=30")' alt="" src="magfa_Http%20v2_files/logo.png" data-src="https://trustseal.enamad.ir/logo.aspx?id=43129&amp;p=aodsvjymlznbqesgzpfv">
			</a>
		</div>
			<!-- Global Site Tag (gtag.js) - Google Analytics -->
		<script async="" src="magfa_Http%20v2_files/js"></script>
		<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-1850726-1');
</script>
		
		</footer>
	<iframe id="iframe" sandbox="allow-same-origin" style="display: none"></iframe>


</body></html>